{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { toast } from \"react-toastify\";\nimport CartService from \"../../services/api/CartService\";\nconst userId = null;\nexport const fetchCart = createAsyncThunk('cart/fetchCart', async () => {\n  const res = await CartService.getAllProducts(userId);\n  return res.items;\n});\nconst initialState = {\n  status: '',\n  cartData: [],\n  productQuantity: 0,\n  totalCount: 0,\n  totalSubAmount: 0,\n  tax: 0\n};\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState,\n  reducers: {\n    addToCart: (state, action) => {\n      const newProduct = action.payload.product;\n      const itemIndex = state.cartData.findIndex(item => {\n        var _item$productId;\n        return (item === null || item === void 0 ? void 0 : (_item$productId = item.productId) === null || _item$productId === void 0 ? void 0 : _item$productId._id) === newProduct._id;\n      });\n      if (itemIndex < 0) {\n        state.cartData.push({\n          productId: newProduct,\n          color: newProduct.inStock[0].color,\n          quantity: 1\n        });\n        state.totalCount += 1;\n        toast.success(\"Add new product successful..\");\n      } else {\n        toast.error(\"Product already in cart!\");\n      }\n    },\n    updateCart: (state, action) => {\n      const {\n        productId,\n        color,\n        quantity\n      } = action.payload;\n      const findProductInCart = state.cartData.findIndex(item => {\n        var _item$productId2;\n        return (item === null || item === void 0 ? void 0 : (_item$productId2 = item.productId) === null || _item$productId2 === void 0 ? void 0 : _item$productId2._id) === productId && (item === null || item === void 0 ? void 0 : item.color) === color;\n      });\n      if (findProductInCart !== -1) {\n        state.cartData[findProductInCart].quantity = quantity;\n      }\n    },\n    deleteCart: (state, action) => {\n      const {\n        productId,\n        color\n      } = action.payload;\n      state.cartData = state.cartData.filter(item => {\n        var _item$productId3;\n        return !((item === null || item === void 0 ? void 0 : (_item$productId3 = item.productId) === null || _item$productId3 === void 0 ? void 0 : _item$productId3._id) === productId && (item === null || item === void 0 ? void 0 : item.color) === color);\n      });\n    },\n    calculateTotalCount: (state, action) => {\n      var _state$cartData;\n      state.totalCount = (_state$cartData = state.cartData) === null || _state$cartData === void 0 ? void 0 : _state$cartData.reduce((total, item) => total + item.quantity, 0);\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchCart.pending, (state, action) => {\n      state.status = 'loading';\n    }).addCase(fetchCart.fulfilled, (state, action) => {\n      state.cartData = action.payload;\n      state.status = 'idle';\n    });\n  }\n});\nexport const {\n  addToCart,\n  updateCart,\n  deleteCart,\n  calculateTotalCount\n} = cartSlice.actions;\nexport default cartSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","toast","CartService","userId","fetchCart","res","getAllProducts","items","initialState","status","cartData","productQuantity","totalCount","totalSubAmount","tax","cartSlice","name","reducers","addToCart","state","action","newProduct","payload","product","itemIndex","findIndex","item","productId","_id","push","color","inStock","quantity","success","error","updateCart","findProductInCart","deleteCart","filter","calculateTotalCount","reduce","total","extraReducers","builder","addCase","pending","fulfilled","actions","reducer"],"sources":["D:/SU25/SDN302 - HOANNN/Shopii-Template/front-end/src/redux/slices/cart.slice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\"\nimport { toast } from \"react-toastify\";\nimport CartService from \"../../services/api/CartService\";\n\nconst userId = null\n\nexport const fetchCart = createAsyncThunk('cart/fetchCart', async () => {\n  const res = await CartService.getAllProducts(userId)\n  return res.items\n})\n\nconst initialState = {\n  status: '',\n  cartData: [],\n  productQuantity: 0,\n  totalCount: 0,\n  totalSubAmount: 0,\n  tax: 0,\n}\n\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState,\n  reducers: {\n    addToCart: (state, action) => {\n      const newProduct = action.payload.product;\n      const itemIndex = state.cartData.findIndex(item => item?.productId?._id === newProduct._id);\n      if (itemIndex < 0) {\n        state.cartData.push({\n          productId: newProduct,\n          color: newProduct.inStock[0].color,\n          quantity: 1,\n        });\n        state.totalCount += 1;\n        toast.success(\"Add new product successful..\");\n      } else {\n        toast.error(\"Product already in cart!\");\n      }\n    },\n    updateCart: (state, action) => {\n      const { productId, color, quantity } = action.payload;\n      const findProductInCart = state.cartData.findIndex(\n        item => item?.productId?._id === productId && item?.color === color\n      );\n      if (findProductInCart !== -1) {\n        state.cartData[findProductInCart].quantity = quantity;\n      }\n    },\n    deleteCart: (state, action) => {\n      const { productId, color } = action.payload;\n      state.cartData = state.cartData.filter(item => !(item?.productId?._id === productId && item?.color === color));\n    },\n    calculateTotalCount: (state, action) => {\n      state.totalCount = state.cartData?.reduce((total, item) => total + item.quantity, 0);\n    }\n  },\n  extraReducers: builder => {\n    builder\n      .addCase(fetchCart.pending, (state, action) => {\n        state.status = 'loading'\n      })\n      .addCase(fetchCart.fulfilled, (state, action) => {\n        state.cartData = action.payload\n        state.status = 'idle'\n      })\n\n  }\n})\n\n\n\n\nexport const { addToCart, updateCart, deleteCart, calculateTotalCount } = cartSlice.actions\n\nexport default cartSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}