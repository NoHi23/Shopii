{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\n\n// Define the base API URL, consistent with cartSlice.js\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:9999/api';\n\n// Asynchronous thunk to apply a voucher by its code\nexport const applyVoucher = createAsyncThunk('voucher/applyVoucher', async (code, _ref) => {\n  let {\n    rejectWithValue,\n    getState\n  } = _ref;\n  try {\n    // Access the token from the auth state\n    const {\n      token\n    } = getState().auth;\n\n    // Configure request headers with the authorization token\n    const config = {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    };\n\n    // Use the API_URL variable for the request\n    const response = await axios.get(`${API_URL}/buyers/vouchers/code/${code}`, config);\n    toast.success(\"Áp dụng mã giảm giá thành công!\");\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response$data;\n    // Extract the error message from the server's response\n    const message = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message;\n    toast.error(message);\n    return rejectWithValue(message);\n  }\n});\nconst voucherSlice = createSlice({\n  name: 'voucher',\n  initialState: {\n    voucher: null,\n    loading: false,\n    error: null\n  },\n  reducers: {\n    // Reducer to clear the voucher from the state\n    clearVoucher: state => {\n      state.voucher = null;\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Handle the pending state of the API call\n    .addCase(applyVoucher.pending, state => {\n      state.loading = true;\n      state.error = null;\n    })\n    // Handle the fulfilled state (successful API call)\n    .addCase(applyVoucher.fulfilled, (state, action) => {\n      state.loading = false;\n      state.voucher = action.payload;\n    })\n    // Handle the rejected state (failed API call)\n    .addCase(applyVoucher.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n      state.voucher = null;\n    });\n  }\n});\nexport const {\n  clearVoucher\n} = voucherSlice.actions;\nexport default voucherSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","toast","API_URL","process","env","REACT_APP_API_URL","applyVoucher","code","rejectWithValue","getState","token","auth","config","headers","Authorization","response","get","success","data","error","message","voucherSlice","name","initialState","voucher","loading","reducers","clearVoucher","state","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","actions","reducer"],"sources":["D:/SU25/SDN302 - HOANNN/Shopii-Template/front-end/src/features/voucher/voucherSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { toast } from 'react-toastify';\r\n\r\n// Define the base API URL, consistent with cartSlice.js\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:9999/api';\r\n\r\n// Asynchronous thunk to apply a voucher by its code\r\nexport const applyVoucher = createAsyncThunk(\r\n  'voucher/applyVoucher',\r\n  async (code, { rejectWithValue, getState }) => {\r\n    try {\r\n      // Access the token from the auth state\r\n      const { token } = getState().auth;\r\n      \r\n      // Configure request headers with the authorization token\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      };\r\n\r\n      // Use the API_URL variable for the request\r\n      const response = await axios.get(`${API_URL}/buyers/vouchers/code/${code}`, config);\r\n      \r\n      toast.success(\"Áp dụng mã giảm giá thành công!\");\r\n      return response.data;\r\n    } catch (error) {\r\n      // Extract the error message from the server's response\r\n      const message = error.response?.data?.message || error.message;\r\n      toast.error(message);\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nconst voucherSlice = createSlice({\r\n  name: 'voucher',\r\n  initialState: {\r\n    voucher: null,\r\n    loading: false,\r\n    error: null,\r\n  },\r\n  reducers: {\r\n    // Reducer to clear the voucher from the state\r\n    clearVoucher: (state) => {\r\n      state.voucher = null;\r\n      state.error = null;\r\n    }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // Handle the pending state of the API call\r\n      .addCase(applyVoucher.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      // Handle the fulfilled state (successful API call)\r\n      .addCase(applyVoucher.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.voucher = action.payload;\r\n      })\r\n      // Handle the rejected state (failed API call)\r\n      .addCase(applyVoucher.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n        state.voucher = null;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { clearVoucher } = voucherSlice.actions;\r\n\r\nexport default voucherSlice.reducer;"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,gBAAgB;;AAEtC;AACA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,2BAA2B;;AAE5E;AACA,OAAO,MAAMC,YAAY,GAAGP,gBAAgB,CAC1C,sBAAsB,EACtB,OAAOQ,IAAI,WAAoC;EAAA,IAAlC;IAAEC,eAAe;IAAEC;EAAS,CAAC;EACxC,IAAI;IACF;IACA,MAAM;MAAEC;IAAM,CAAC,GAAGD,QAAQ,EAAE,CAACE,IAAI;;IAEjC;IACA,MAAMC,MAAM,GAAG;MACbC,OAAO,EAAE;QACPC,aAAa,EAAG,UAASJ,KAAM;MACjC;IACF,CAAC;;IAED;IACA,MAAMK,QAAQ,GAAG,MAAMf,KAAK,CAACgB,GAAG,CAAE,GAAEd,OAAQ,yBAAwBK,IAAK,EAAC,EAAEK,MAAM,CAAC;IAEnFX,KAAK,CAACgB,OAAO,CAAC,iCAAiC,CAAC;IAChD,OAAOF,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA;IACd;IACA,MAAMC,OAAO,GAAG,oBAAAD,KAAK,CAACJ,QAAQ,4EAAd,gBAAgBG,IAAI,yDAApB,qBAAsBE,OAAO,KAAID,KAAK,CAACC,OAAO;IAC9DnB,KAAK,CAACkB,KAAK,CAACC,OAAO,CAAC;IACpB,OAAOZ,eAAe,CAACY,OAAO,CAAC;EACjC;AACF,CAAC,CACF;AAED,MAAMC,YAAY,GAAGvB,WAAW,CAAC;EAC/BwB,IAAI,EAAE,SAAS;EACfC,YAAY,EAAE;IACZC,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE,KAAK;IACdN,KAAK,EAAE;EACT,CAAC;EACDO,QAAQ,EAAE;IACR;IACAC,YAAY,EAAGC,KAAK,IAAK;MACvBA,KAAK,CAACJ,OAAO,GAAG,IAAI;MACpBI,KAAK,CAACT,KAAK,GAAG,IAAI;IACpB;EACF,CAAC;EACDU,aAAa,EAAGC,OAAO,IAAK;IAC1BA;IACE;IAAA,CACCC,OAAO,CAACzB,YAAY,CAAC0B,OAAO,EAAGJ,KAAK,IAAK;MACxCA,KAAK,CAACH,OAAO,GAAG,IAAI;MACpBG,KAAK,CAACT,KAAK,GAAG,IAAI;IACpB,CAAC;IACD;IAAA,CACCY,OAAO,CAACzB,YAAY,CAAC2B,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAClDN,KAAK,CAACH,OAAO,GAAG,KAAK;MACrBG,KAAK,CAACJ,OAAO,GAAGU,MAAM,CAACC,OAAO;IAChC,CAAC;IACD;IAAA,CACCJ,OAAO,CAACzB,YAAY,CAAC8B,QAAQ,EAAE,CAACR,KAAK,EAAEM,MAAM,KAAK;MACjDN,KAAK,CAACH,OAAO,GAAG,KAAK;MACrBG,KAAK,CAACT,KAAK,GAAGe,MAAM,CAACC,OAAO;MAC5BP,KAAK,CAACJ,OAAO,GAAG,IAAI;IACtB,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEG;AAAa,CAAC,GAAGN,YAAY,CAACgB,OAAO;AAEpD,eAAehB,YAAY,CAACiB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}