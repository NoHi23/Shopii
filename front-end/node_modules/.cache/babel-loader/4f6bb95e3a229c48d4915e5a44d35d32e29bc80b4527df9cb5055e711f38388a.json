{"ast":null,"code":"var _jsxFileName = \"D:\\\\SU25\\\\SDN302 - HOANNN\\\\Shopii-Template\\\\front-end\\\\src\\\\pages\\\\Payment\\\\Payment.jsx\",\n  _s = $RefreshSig$();\n// Payment.jsx\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport { createPayment, resetPayment, checkPaymentStatus, cancelPaymentPolling } from \"../../features/payment/paymentSlice\";\nimport axios from \"axios\";\nimport { motion } from \"framer-motion\";\nimport { Box, Container, Typography, Radio, RadioGroup, FormControlLabel, FormControl, Button, Paper, Divider, CircularProgress, Grid } from \"@mui/material\";\nimport PaymentIcon from \"@mui/icons-material/Payment\";\nimport LocalAtmIcon from \"@mui/icons-material/LocalAtm\";\nimport HomeIcon from \"@mui/icons-material/Home\";\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Payment = () => {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const payosIframeRef = useRef(null);\n\n  // Ensure orderId is a string and handle null/undefined cases safely\n  const locationState = location.state || {};\n  const orderId = locationState.orderId ? String(locationState.orderId) : null;\n  const totalPrice = locationState.totalPrice || 0;\n  const preferredMethod = locationState.preferredMethod || 'PayPal';\n  const comingFromOrderPage = Boolean(locationState.directPayment); // Flag to check if coming from order pages\n\n  // Đảm bảo totalPrice là số nguyên cho các API thanh toán\n  const formattedPrice = Number(totalPrice).toFixed(2);\n  const roundedPrice = Math.round(totalPrice);\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState(preferredMethod);\n  const [showPayosIframe, setShowPayosIframe] = useState(false);\n  const [paymentPolling, setPaymentPolling] = useState(false);\n  const [pollingInterval, setPollingInterval] = useState(null);\n  const [pollingCount, setPollingCount] = useState(0);\n  const MAX_POLLING_RETRIES = 10; // Maximum number of retries\n\n  const {\n    payment,\n    paymentStatus,\n    loading,\n    error,\n    success\n  } = useSelector(state => state.payment);\n  const {\n    token\n  } = useSelector(state => state.auth);\n\n  // Auto-process payment if coming from order history/detail pages with PayOS method\n  useEffect(() => {\n    if (orderId && locationState.directPayment && selectedPaymentMethod === 'PayOS') {\n      handlePayment();\n    }\n  }, []);\n\n  // Hàm kiểm tra trạng thái thanh toán\n  const checkPaymentStatusHandler = async () => {\n    try {\n      // Check if we've already registered this payment as completed\n      const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n      if (paymentCompleted === 'true') {\n        console.log(`Payment ${orderId} was already completed, forcefully stopping polling`);\n        clearPolling();\n        navigate('/', {\n          replace: true\n        });\n        return true;\n      }\n\n      // Increment polling counter\n      setPollingCount(prev => prev + 1);\n      console.log(`Checking payment status for order: ${orderId} (attempt ${pollingCount + 1}/${MAX_POLLING_RETRIES})`);\n\n      // Stop if we've reached max retries\n      if (pollingCount >= MAX_POLLING_RETRIES) {\n        console.log(`Reached max polling retries (${MAX_POLLING_RETRIES}), stopping polling`);\n        clearPolling();\n\n        // If we've hit max retries, go to payment result page anyway\n        navigate('/payment-result', {\n          state: {\n            orderId: orderId\n          },\n          replace: true\n        });\n        return false;\n      }\n\n      // Dispatch action kiểm tra trạng thái\n      const resultAction = await dispatch(checkPaymentStatus(orderId));\n      if (checkPaymentStatus.fulfilled.match(resultAction)) {\n        var _data$payment;\n        const data = resultAction.payload;\n        const paymentStatus = data === null || data === void 0 ? void 0 : (_data$payment = data.payment) === null || _data$payment === void 0 ? void 0 : _data$payment.status;\n        console.log('Payment status check result:', paymentStatus);\n\n        // Stop polling if payment is marked as paid - chỉ cần payment is \"paid\" là dừng callback\n        if (paymentStatus === 'paid') {\n          console.log('Payment is paid, forcefully stopping all polling');\n\n          // Add a flag to sessionStorage to prevent future polling\n          sessionStorage.setItem(`payment_${orderId}_completed`, 'true');\n\n          // Force clear all polling before any UI updates or navigation\n          if (pollingInterval) {\n            clearInterval(pollingInterval);\n          }\n\n          // Set state to stop polling\n          setPollingInterval(null);\n          setPaymentPolling(false);\n\n          // Clear from Redux state\n          dispatch(cancelPaymentPolling());\n\n          // Show success message\n          toast.success(\"Thanh toán thành công!\");\n\n          // Navigate directly to home page instead of payment result\n          setTimeout(() => {\n            navigate('/', {\n              replace: true\n            });\n          }, 500);\n          return true;\n        }\n        // Stop polling if payment failed\n        else if (paymentStatus === 'failed') {\n          console.log('Payment failed, forcefully stopping all polling');\n\n          // Force clear all polling\n          if (pollingInterval) {\n            clearInterval(pollingInterval);\n          }\n\n          // Set state to stop polling\n          setPollingInterval(null);\n          setPaymentPolling(false);\n\n          // Clear from Redux state\n          dispatch(cancelPaymentPolling());\n          toast.error(\"Thanh toán thất bại!\");\n\n          // Navigate to payment result page\n          navigate('/payment-result', {\n            state: {\n              status: 'failed',\n              orderId: orderId\n            },\n            replace: true\n          });\n          return false;\n        }\n      } else {\n        console.error('Failed to check payment status:', resultAction.error);\n      }\n    } catch (err) {\n      console.error(\"Lỗi khi kiểm tra trạng thái thanh toán:\", err);\n    }\n    return false;\n  };\n\n  // Hàm xóa interval polling\n  const clearPolling = () => {\n    console.log('Clearing polling interval');\n\n    // Cancel any outstanding requests\n    const controller = new AbortController();\n    controller.abort();\n\n    // Clear the interval if it exists\n    if (pollingInterval) {\n      console.log('Clearing polling interval ID:', pollingInterval);\n      clearInterval(pollingInterval);\n      setPollingInterval(null);\n    }\n\n    // Reset state\n    setPaymentPolling(false);\n\n    // Clear in Redux\n    dispatch(cancelPaymentPolling());\n\n    // If there's an orderId and the payment was successful, mark it as completed\n    if (orderId) {\n      const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n      if (paymentCompleted === 'true') {\n        console.log(`Payment ${orderId} already marked as completed`);\n      } else if ((payment === null || payment === void 0 ? void 0 : payment.status) === 'paid') {\n        console.log(`Marking payment ${orderId} as completed`);\n        sessionStorage.setItem(`payment_${orderId}_completed`, 'true');\n      }\n    }\n  };\n\n  // Khởi tạo polling\n  const startPaymentPolling = () => {\n    // Xóa polling cũ nếu có\n    clearPolling();\n\n    // Check if payment was already completed to avoid starting polling\n    const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n    if (paymentCompleted === 'true') {\n      console.log(`Payment ${orderId} was already completed, not starting polling`);\n      // Navigate directly to home\n      navigate('/', {\n        replace: true\n      });\n      return;\n    }\n\n    // Reset polling count\n    setPollingCount(0);\n\n    // Tạo polling mới\n    console.log('Starting payment status polling');\n    setPaymentPolling(true);\n\n    // Kiểm tra ngay lần đầu\n    checkPaymentStatusHandler();\n    const interval = setInterval(() => {\n      checkPaymentStatusHandler();\n    }, 5000); // Check every 5 seconds\n\n    console.log('Setting polling interval ID:', interval);\n    setPollingInterval(interval);\n\n    // Tự động dừng polling sau 3 phút để tránh vòng lặp vô hạn\n    setTimeout(() => {\n      if (pollingInterval) {\n        console.log('Auto stopping polling after timeout');\n        clearPolling();\n        // Navigate back to order history\n        navigate('/order-history', {\n          replace: true\n        });\n      }\n    }, 3 * 60 * 1000); // Reduced from 5 to 3 minutes\n  };\n\n  // Xóa polling khi component unmount\n  useEffect(() => {\n    return () => {\n      console.log('Payment component unmounting, clearing polling');\n      clearPolling();\n    };\n  }, []);\n\n  // Thêm tuyến bảo vệ để đảm bảo dừng polling khi trang thay đổi\n  useEffect(() => {\n    const handleRouteChange = () => {\n      console.log('Route change detected, clearing polling');\n      // Force clear all polling\n      if (pollingInterval) {\n        clearInterval(pollingInterval);\n        setPollingInterval(null);\n        setPaymentPolling(false);\n      }\n      // Dispatch to Redux\n      dispatch(cancelPaymentPolling());\n    };\n\n    // Lắng nghe sự kiện trước khi navigate\n    window.addEventListener('beforeunload', handleRouteChange);\n\n    // Capture navigation events\n    const unlisten = navigate.listen && navigate.listen(() => {\n      console.log('Navigation detected, clearing polling');\n      handleRouteChange();\n    });\n    return () => {\n      window.removeEventListener('beforeunload', handleRouteChange);\n      if (unlisten) unlisten();\n\n      // Force clear polling on unmount\n      if (pollingInterval) {\n        clearInterval(pollingInterval);\n        setPollingInterval(null);\n        setPaymentPolling(false);\n      }\n      dispatch(cancelPaymentPolling());\n    };\n  }, [pollingInterval, dispatch]);\n\n  // Polling for payment status - add check for completed payments\n  useEffect(() => {\n    // Check if payment was already completed\n    const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n    if (paymentCompleted === 'true') {\n      console.log(`Payment ${orderId} was already completed, skipping polling`);\n      return;\n    }\n    if (success && selectedPaymentMethod === 'PayOS') {\n      if (payment !== null && payment !== void 0 && payment.paymentUrl) {\n        startPaymentPolling();\n      }\n    }\n\n    // Đảm bảo dừng polling khi rời khỏi component\n    return () => clearPolling();\n  }, [success, selectedPaymentMethod, payment]);\n  useEffect(() => {\n    if (success) {\n      if (selectedPaymentMethod === 'PayOS') {\n        if (payment !== null && payment !== void 0 && payment.paymentUrl) {\n          setShowPayosIframe(true);\n          toast.success(\"Cổng thanh toán PayOS đã mở\");\n        } else {\n          console.error(\"Phản hồi PayOS thiếu URL thanh toán:\", payment);\n          toast.error(\"Không thể tạo liên kết thanh toán PayOS\");\n          dispatch(resetPayment());\n        }\n      } else if (selectedPaymentMethod === 'COD') {\n        toast.success(\"Đã tạo đơn hàng thanh toán khi nhận hàng thành công.\");\n        // Clear any polling before navigating\n        clearPolling();\n        setTimeout(() => {\n          navigate('/payment-result', {\n            state: {\n              status: 'paid',\n              orderId: orderId\n            },\n            replace: true\n          });\n        }, 2000);\n      }\n    }\n    if (error) {\n      toast.error(error);\n      dispatch(resetPayment());\n    }\n  }, [success, error, payment, selectedPaymentMethod, dispatch, orderId, navigate]);\n  if (!orderId) {\n    console.error(\"Missing orderId in location state:\", locationState);\n    toast.error(\"Order information not found.\");\n    navigate(\"/\");\n    return null;\n  }\n\n  // Handle PayOS iframe loading error\n  const handlePayOsIframeError = () => {\n    console.error(\"Error loading PayOS payment iframe\");\n    toast.error(\"Payment gateway failed to load. Please try another payment method.\");\n    setShowPayosIframe(false);\n    dispatch(resetPayment());\n  };\n  const handlePayment = () => {\n    if (!orderId) {\n      toast.error(\"Order information not found.\");\n      navigate(\"/\");\n      return;\n    }\n    if (selectedPaymentMethod === 'PayOS') {\n      toast.info(\"Opening payment gateway...\");\n    }\n\n    // Ensure orderId is passed as a string\n    dispatch(createPayment({\n      orderId: String(orderId),\n      method: selectedPaymentMethod,\n      replaceExisting: comingFromOrderPage // Delete previous payment records if coming from order history/detail\n    }));\n  };\n\n  // Xử lý khi đóng cổng thanh toán\n  const handleBackToHome = () => {\n    setShowPayosIframe(false);\n    clearPolling();\n    dispatch(resetPayment());\n    navigate(\"/\");\n  };\n\n  // Open PayOS payment page in new tab\n  const openPaymentPage = () => {\n    if (payment !== null && payment !== void 0 && payment.paymentUrl) {\n      window.open(payment.paymentUrl, '_blank');\n    }\n  };\n\n  // If coming from order history or order detail, show only PayOS option\n  const renderPaymentMethods = () => {\n    // If coming from order page, only show PayOS option\n    if (comingFromOrderPage) {\n      return /*#__PURE__*/_jsxDEV(Paper, {\n        variant: \"outlined\",\n        sx: {\n          mb: 2,\n          p: 2,\n          borderRadius: 2,\n          borderColor: '#0F52BA',\n          backgroundColor: 'rgba(15, 82, 186, 0.04)',\n          transition: 'all 0.2s'\n        },\n        children: /*#__PURE__*/_jsxDEV(FormControlLabel, {\n          value: \"PayPal\",\n          control: /*#__PURE__*/_jsxDEV(Radio, {\n            sx: {\n              color: '#0F52BA',\n              '&.Mui-checked': {\n                color: '#0F52BA'\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 22\n          }, this),\n          label: /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              display: 'flex',\n              alignItems: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(PaymentIcon, {\n              sx: {\n                mr: 1,\n                color: '#0F52BA'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              children: \"PayPal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 15\n          }, this),\n          sx: {\n            width: '100%'\n          },\n          checked: true,\n          disabled: true // Cannot be changed\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this);\n    }\n\n    // Otherwise show all payment options\n    return /*#__PURE__*/_jsxDEV(RadioGroup, {\n      value: selectedPaymentMethod,\n      onChange: e => setSelectedPaymentMethod(e.target.value),\n      children: [/*#__PURE__*/_jsxDEV(Paper, {\n        variant: \"outlined\",\n        sx: {\n          mb: 2,\n          p: 2,\n          borderRadius: 2,\n          borderColor: selectedPaymentMethod === 'COD' ? '#0F52BA' : 'divider',\n          backgroundColor: selectedPaymentMethod === 'COD' ? 'rgba(15, 82, 186, 0.04)' : 'transparent',\n          transition: 'all 0.2s'\n        },\n        children: /*#__PURE__*/_jsxDEV(FormControlLabel, {\n          value: \"COD\",\n          control: /*#__PURE__*/_jsxDEV(Radio, {\n            sx: {\n              color: '#0F52BA',\n              '&.Mui-checked': {\n                color: '#0F52BA'\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 22\n          }, this),\n          label: /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              display: 'flex',\n              alignItems: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(LocalAtmIcon, {\n              sx: {\n                mr: 1,\n                color: '#0F52BA'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              children: \"Cash on Delivery (COD)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 15\n          }, this),\n          sx: {\n            width: '100%'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Paper, {\n        variant: \"outlined\",\n        sx: {\n          mb: 2,\n          p: 2,\n          borderRadius: 2,\n          borderColor: selectedPaymentMethod === 'PayOS' ? '#0F52BA' : 'divider',\n          backgroundColor: selectedPaymentMethod === 'PayOS' ? 'rgba(15, 82, 186, 0.04)' : 'transparent',\n          transition: 'all 0.2s'\n        },\n        children: /*#__PURE__*/_jsxDEV(FormControlLabel, {\n          value: \"PayOS\",\n          control: /*#__PURE__*/_jsxDEV(Radio, {\n            sx: {\n              color: '#0F52BA',\n              '&.Mui-checked': {\n                color: '#0F52BA'\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 22\n          }, this),\n          label: /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              display: 'flex',\n              alignItems: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(PaymentIcon, {\n              sx: {\n                mr: 1,\n                color: '#0F52BA'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              children: \"PayOS\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 15\n          }, this),\n          sx: {\n            width: '100%'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    sx: {\n      py: 6\n    },\n    children: /*#__PURE__*/_jsxDEV(motion.div, {\n      initial: {\n        opacity: 0,\n        y: 20\n      },\n      animate: {\n        opacity: 1,\n        y: 0\n      },\n      transition: {\n        duration: 0.5\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h4\",\n        component: \"h1\",\n        gutterBottom: true,\n        sx: {\n          fontWeight: 700,\n          color: '#0F52BA',\n          position: 'relative',\n          pb: 2,\n          mb: 4,\n          '&:after': {\n            content: '\"\"',\n            position: 'absolute',\n            bottom: 0,\n            left: 0,\n            width: '60px',\n            height: '4px',\n            backgroundColor: '#0F52BA',\n            borderRadius: '2px'\n          }\n        },\n        children: [/*#__PURE__*/_jsxDEV(PaymentIcon, {\n          sx: {\n            mr: 1,\n            verticalAlign: 'middle'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 11\n        }, this), comingFromOrderPage ? 'Payment Method: PayOS' : 'Select Payment Method']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 9\n      }, this), showPayosIframe && payment !== null && payment !== void 0 && payment.paymentUrl ? /*#__PURE__*/_jsxDEV(Paper, {\n        elevation: 3,\n        sx: {\n          p: 4,\n          borderRadius: 2,\n          maxWidth: 800,\n          mx: 'auto',\n          overflow: 'hidden',\n          boxShadow: '0 10px 30px rgba(0,0,0,0.1)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h5\",\n          fontWeight: 600,\n          mb: 3,\n          children: \"PayOS Payment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            height: \"600px\",\n            border: '1px solid #eaeaea',\n            borderRadius: 2,\n            overflow: 'hidden',\n            mb: 3\n          },\n          children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n            ref: payosIframeRef,\n            src: payment.paymentUrl,\n            style: {\n              width: \"100%\",\n              height: \"100%\",\n              border: \"none\"\n            },\n            title: \"PayOS Payment\",\n            allow: \"payment\",\n            onError: handlePayOsIframeError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 529,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 2,\n          justifyContent: \"space-between\",\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              onClick: openPaymentPage,\n              startIcon: /*#__PURE__*/_jsxDEV(PaymentIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 547,\n                columnNumber: 30\n              }, this),\n              sx: {\n                backgroundColor: '#0F52BA',\n                '&:hover': {\n                  backgroundColor: '#0A3C8A'\n                },\n                px: 3,\n                py: 1\n              },\n              children: \"Open in new tab\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outlined\",\n              onClick: handleBackToHome,\n              startIcon: /*#__PURE__*/_jsxDEV(HomeIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 564,\n                columnNumber: 30\n              }, this),\n              sx: {\n                borderColor: '#0F52BA',\n                color: '#0F52BA',\n                '&:hover': {\n                  borderColor: '#0A3C8A',\n                  backgroundColor: 'rgba(15, 82, 186, 0.04)'\n                },\n                px: 3,\n                py: 1\n              },\n              children: \"Return to home\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 561,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 4,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 7,\n          children: /*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 3,\n            sx: {\n              p: 4,\n              borderRadius: 2,\n              height: '100%',\n              boxShadow: '0 10px 30px rgba(0,0,0,0.1)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h5\",\n              fontWeight: 600,\n              mb: 3,\n              children: comingFromOrderPage ? 'Payment Method' : 'Choose Payment Method'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 593,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n              component: \"fieldset\",\n              sx: {\n                width: '100%'\n              },\n              children: renderPaymentMethods()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 17\n            }, this), !success && /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              fullWidth: true,\n              size: \"large\",\n              onClick: handlePayment,\n              disabled: loading,\n              sx: {\n                mt: 3,\n                py: 1.5,\n                backgroundColor: '#0F52BA',\n                '&:hover': {\n                  backgroundColor: '#0A3C8A'\n                },\n                fontWeight: 600\n              },\n              children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n                  size: 24,\n                  sx: {\n                    color: 'white',\n                    mr: 1\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 620,\n                  columnNumber: 25\n                }, this), \"Processing...\"]\n              }, void 0, true) : 'Proceed to Payment'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 19\n            }, this), success && /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outlined\",\n              fullWidth: true,\n              size: \"large\",\n              onClick: handleBackToHome,\n              startIcon: /*#__PURE__*/_jsxDEV(HomeIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 635,\n                columnNumber: 32\n              }, this),\n              sx: {\n                mt: 3,\n                py: 1.5,\n                borderColor: '#0F52BA',\n                color: '#0F52BA',\n                '&:hover': {\n                  borderColor: '#0A3C8A',\n                  backgroundColor: 'rgba(15, 82, 186, 0.04)'\n                },\n                fontWeight: 600\n              },\n              children: \"Return to Home\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 630,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 584,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 583,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 5,\n          children: [/*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 3,\n            sx: {\n              p: 4,\n              borderRadius: 2,\n              boxShadow: '0 10px 30px rgba(0,0,0,0.1)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h5\",\n              fontWeight: 600,\n              mb: 3,\n              children: \"Order Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 663,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                mb: 3\n              },\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  mb: 2\n                },\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  color: \"text.secondary\",\n                  children: \"Order ID:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 669,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  fontWeight: 500,\n                  children: orderId\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 670,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 668,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Divider, {\n                sx: {\n                  my: 2\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 673,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  mb: 1\n                },\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h6\",\n                  children: \"Total:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 676,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h6\",\n                  fontWeight: 700,\n                  color: \"#0F52BA\",\n                  children: [\"$\", formattedPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 677,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 675,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 667,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                p: 2,\n                backgroundColor: 'rgba(15, 82, 186, 0.04)',\n                borderRadius: 2,\n                border: '1px dashed #0F52BA'\n              },\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                color: \"text.secondary\",\n                children: [\"By proceeding with this payment, you agree to our terms and conditions.\", !comingFromOrderPage && ' For Cash on Delivery orders, please have the exact amount ready at the time of delivery.']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 689,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 683,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 655,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"text\",\n            startIcon: /*#__PURE__*/_jsxDEV(ArrowBackIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 698,\n              columnNumber: 28\n            }, this),\n            onClick: () => navigate(-1),\n            sx: {\n              mt: 2,\n              color: '#0F52BA',\n              '&:hover': {\n                backgroundColor: 'rgba(15, 82, 186, 0.04)'\n              }\n            },\n            children: \"Back to Checkout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 654,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 582,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 473,\n    columnNumber: 5\n  }, this);\n};\n_s(Payment, \"jAzSaLnK3IMN3T7KOa71bJOEys0=\", false, function () {\n  return [useLocation, useNavigate, useDispatch, useSelector, useSelector];\n});\n_c = Payment;\nexport default Payment;\nvar _c;\n$RefreshReg$(_c, \"Payment\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useLocation","useNavigate","useDispatch","useSelector","toast","createPayment","resetPayment","checkPaymentStatus","cancelPaymentPolling","axios","motion","Box","Container","Typography","Radio","RadioGroup","FormControlLabel","FormControl","Button","Paper","Divider","CircularProgress","Grid","PaymentIcon","LocalAtmIcon","HomeIcon","ArrowBackIcon","Payment","location","navigate","dispatch","payosIframeRef","locationState","state","orderId","String","totalPrice","preferredMethod","comingFromOrderPage","Boolean","directPayment","formattedPrice","Number","toFixed","roundedPrice","Math","round","selectedPaymentMethod","setSelectedPaymentMethod","showPayosIframe","setShowPayosIframe","paymentPolling","setPaymentPolling","pollingInterval","setPollingInterval","pollingCount","setPollingCount","MAX_POLLING_RETRIES","payment","paymentStatus","loading","error","success","token","auth","handlePayment","checkPaymentStatusHandler","paymentCompleted","sessionStorage","getItem","console","log","clearPolling","replace","prev","resultAction","fulfilled","match","data","payload","status","setItem","clearInterval","setTimeout","err","controller","AbortController","abort","startPaymentPolling","interval","setInterval","handleRouteChange","window","addEventListener","unlisten","listen","removeEventListener","paymentUrl","handlePayOsIframeError","info","method","replaceExisting","handleBackToHome","openPaymentPage","open","renderPaymentMethods","mb","p","borderRadius","borderColor","backgroundColor","transition","color","display","alignItems","mr","width","e","target","value","py","opacity","y","duration","fontWeight","position","pb","content","bottom","left","height","verticalAlign","maxWidth","mx","overflow","boxShadow","border","px","mt","justifyContent","my"],"sources":["D:/SU25/SDN302 - HOANNN/Shopii-Template/front-end/src/pages/Payment/Payment.jsx"],"sourcesContent":["// Payment.jsx\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport { createPayment, resetPayment, checkPaymentStatus, cancelPaymentPolling } from \"../../features/payment/paymentSlice\";\nimport axios from \"axios\";\nimport { motion } from \"framer-motion\";\nimport {\n  Box,\n  Container,\n  Typography,\n  Radio,\n  RadioGroup,\n  FormControlLabel,\n  FormControl,\n  Button,\n  Paper,\n  Divider,\n  CircularProgress,\n  Grid\n} from \"@mui/material\";\nimport PaymentIcon from \"@mui/icons-material/Payment\";\nimport LocalAtmIcon from \"@mui/icons-material/LocalAtm\";\nimport HomeIcon from \"@mui/icons-material/Home\";\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\n\nconst Payment = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const payosIframeRef = useRef(null);\n\n  // Ensure orderId is a string and handle null/undefined cases safely\n  const locationState = location.state || {};\n  const orderId = locationState.orderId ? String(locationState.orderId) : null;\n  const totalPrice = locationState.totalPrice || 0;\n  const preferredMethod = locationState.preferredMethod || 'PayPal';\n  const comingFromOrderPage = Boolean(locationState.directPayment); // Flag to check if coming from order pages\n\n  // Đảm bảo totalPrice là số nguyên cho các API thanh toán\n  const formattedPrice = Number(totalPrice).toFixed(2);\n  const roundedPrice = Math.round(totalPrice);\n\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState(preferredMethod);\n  const [showPayosIframe, setShowPayosIframe] = useState(false);\n  const [paymentPolling, setPaymentPolling] = useState(false);\n  const [pollingInterval, setPollingInterval] = useState(null);\n  const [pollingCount, setPollingCount] = useState(0);\n  const MAX_POLLING_RETRIES = 10; // Maximum number of retries\n\n  const { payment, paymentStatus, loading, error, success } = useSelector((state) => state.payment);\n  const { token } = useSelector((state) => state.auth);\n\n  // Auto-process payment if coming from order history/detail pages with PayOS method\n  useEffect(() => {\n    if (orderId && locationState.directPayment && selectedPaymentMethod === 'PayOS') {\n      handlePayment();\n    }\n  }, []);\n\n  // Hàm kiểm tra trạng thái thanh toán\n  const checkPaymentStatusHandler = async () => {\n    try {\n      // Check if we've already registered this payment as completed\n      const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n      if (paymentCompleted === 'true') {\n        console.log(`Payment ${orderId} was already completed, forcefully stopping polling`);\n        clearPolling();\n        navigate('/', { replace: true });\n        return true;\n      }\n\n      // Increment polling counter\n      setPollingCount(prev => prev + 1);\n\n      console.log(`Checking payment status for order: ${orderId} (attempt ${pollingCount + 1}/${MAX_POLLING_RETRIES})`);\n\n      // Stop if we've reached max retries\n      if (pollingCount >= MAX_POLLING_RETRIES) {\n        console.log(`Reached max polling retries (${MAX_POLLING_RETRIES}), stopping polling`);\n        clearPolling();\n\n        // If we've hit max retries, go to payment result page anyway\n        navigate('/payment-result', {\n          state: { orderId: orderId },\n          replace: true\n        });\n        return false;\n      }\n\n      // Dispatch action kiểm tra trạng thái\n      const resultAction = await dispatch(checkPaymentStatus(orderId));\n      if (checkPaymentStatus.fulfilled.match(resultAction)) {\n        const data = resultAction.payload;\n        const paymentStatus = data?.payment?.status;\n\n        console.log('Payment status check result:', paymentStatus);\n\n        // Stop polling if payment is marked as paid - chỉ cần payment is \"paid\" là dừng callback\n        if (paymentStatus === 'paid') {\n          console.log('Payment is paid, forcefully stopping all polling');\n\n          // Add a flag to sessionStorage to prevent future polling\n          sessionStorage.setItem(`payment_${orderId}_completed`, 'true');\n\n          // Force clear all polling before any UI updates or navigation\n          if (pollingInterval) {\n            clearInterval(pollingInterval);\n          }\n\n          // Set state to stop polling\n          setPollingInterval(null);\n          setPaymentPolling(false);\n\n          // Clear from Redux state\n          dispatch(cancelPaymentPolling());\n\n          // Show success message\n          toast.success(\"Thanh toán thành công!\");\n\n          // Navigate directly to home page instead of payment result\n          setTimeout(() => {\n            navigate('/', { replace: true });\n          }, 500);\n\n          return true;\n        }\n        // Stop polling if payment failed\n        else if (paymentStatus === 'failed') {\n          console.log('Payment failed, forcefully stopping all polling');\n\n          // Force clear all polling\n          if (pollingInterval) {\n            clearInterval(pollingInterval);\n          }\n\n          // Set state to stop polling\n          setPollingInterval(null);\n          setPaymentPolling(false);\n\n          // Clear from Redux state\n          dispatch(cancelPaymentPolling());\n\n          toast.error(\"Thanh toán thất bại!\");\n\n          // Navigate to payment result page\n          navigate('/payment-result', {\n            state: { status: 'failed', orderId: orderId },\n            replace: true\n          });\n          return false;\n        }\n      } else {\n        console.error('Failed to check payment status:', resultAction.error);\n      }\n    } catch (err) {\n      console.error(\"Lỗi khi kiểm tra trạng thái thanh toán:\", err);\n    }\n    return false;\n  };\n\n  // Hàm xóa interval polling\n  const clearPolling = () => {\n    console.log('Clearing polling interval');\n\n    // Cancel any outstanding requests\n    const controller = new AbortController();\n    controller.abort();\n\n    // Clear the interval if it exists\n    if (pollingInterval) {\n      console.log('Clearing polling interval ID:', pollingInterval);\n      clearInterval(pollingInterval);\n      setPollingInterval(null);\n    }\n\n    // Reset state\n    setPaymentPolling(false);\n\n    // Clear in Redux\n    dispatch(cancelPaymentPolling());\n\n    // If there's an orderId and the payment was successful, mark it as completed\n    if (orderId) {\n      const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n      if (paymentCompleted === 'true') {\n        console.log(`Payment ${orderId} already marked as completed`);\n      } else if (payment?.status === 'paid') {\n        console.log(`Marking payment ${orderId} as completed`);\n        sessionStorage.setItem(`payment_${orderId}_completed`, 'true');\n      }\n    }\n  };\n\n  // Khởi tạo polling\n  const startPaymentPolling = () => {\n    // Xóa polling cũ nếu có\n    clearPolling();\n\n    // Check if payment was already completed to avoid starting polling\n    const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n    if (paymentCompleted === 'true') {\n      console.log(`Payment ${orderId} was already completed, not starting polling`);\n      // Navigate directly to home\n      navigate('/', { replace: true });\n      return;\n    }\n\n    // Reset polling count\n    setPollingCount(0);\n\n    // Tạo polling mới\n    console.log('Starting payment status polling');\n    setPaymentPolling(true);\n\n    // Kiểm tra ngay lần đầu\n    checkPaymentStatusHandler();\n\n    const interval = setInterval(() => {\n      checkPaymentStatusHandler();\n    }, 5000); // Check every 5 seconds\n\n    console.log('Setting polling interval ID:', interval);\n    setPollingInterval(interval);\n\n    // Tự động dừng polling sau 3 phút để tránh vòng lặp vô hạn\n    setTimeout(() => {\n      if (pollingInterval) {\n        console.log('Auto stopping polling after timeout');\n        clearPolling();\n        // Navigate back to order history\n        navigate('/order-history', { replace: true });\n      }\n    }, 3 * 60 * 1000); // Reduced from 5 to 3 minutes\n  };\n\n  // Xóa polling khi component unmount\n  useEffect(() => {\n    return () => {\n      console.log('Payment component unmounting, clearing polling');\n      clearPolling();\n    };\n  }, []);\n\n  // Thêm tuyến bảo vệ để đảm bảo dừng polling khi trang thay đổi\n  useEffect(() => {\n    const handleRouteChange = () => {\n      console.log('Route change detected, clearing polling');\n      // Force clear all polling\n      if (pollingInterval) {\n        clearInterval(pollingInterval);\n        setPollingInterval(null);\n        setPaymentPolling(false);\n      }\n      // Dispatch to Redux\n      dispatch(cancelPaymentPolling());\n    };\n\n    // Lắng nghe sự kiện trước khi navigate\n    window.addEventListener('beforeunload', handleRouteChange);\n\n    // Capture navigation events\n    const unlisten = navigate.listen && navigate.listen(() => {\n      console.log('Navigation detected, clearing polling');\n      handleRouteChange();\n    });\n\n    return () => {\n      window.removeEventListener('beforeunload', handleRouteChange);\n      if (unlisten) unlisten();\n\n      // Force clear polling on unmount\n      if (pollingInterval) {\n        clearInterval(pollingInterval);\n        setPollingInterval(null);\n        setPaymentPolling(false);\n      }\n\n      dispatch(cancelPaymentPolling());\n    };\n  }, [pollingInterval, dispatch]);\n\n  // Polling for payment status - add check for completed payments\n  useEffect(() => {\n    // Check if payment was already completed\n    const paymentCompleted = sessionStorage.getItem(`payment_${orderId}_completed`);\n    if (paymentCompleted === 'true') {\n      console.log(`Payment ${orderId} was already completed, skipping polling`);\n      return;\n    }\n\n    if (success && selectedPaymentMethod === 'PayOS') {\n      if (payment?.paymentUrl) {\n        startPaymentPolling();\n      }\n    }\n\n    // Đảm bảo dừng polling khi rời khỏi component\n    return () => clearPolling();\n  }, [success, selectedPaymentMethod, payment]);\n\n  useEffect(() => {\n    if (success) {\n      if (selectedPaymentMethod === 'PayOS') {\n        if (payment?.paymentUrl) {\n          setShowPayosIframe(true);\n          toast.success(\"Cổng thanh toán PayOS đã mở\");\n        } else {\n          console.error(\"Phản hồi PayOS thiếu URL thanh toán:\", payment);\n          toast.error(\"Không thể tạo liên kết thanh toán PayOS\");\n          dispatch(resetPayment());\n        }\n      } else if (selectedPaymentMethod === 'COD') {\n        toast.success(\"Đã tạo đơn hàng thanh toán khi nhận hàng thành công.\");\n        // Clear any polling before navigating\n        clearPolling();\n        setTimeout(() => {\n          navigate('/payment-result', {\n            state: { status: 'paid', orderId: orderId },\n            replace: true\n          });\n        }, 2000);\n      }\n    }\n\n    if (error) {\n      toast.error(error);\n      dispatch(resetPayment());\n    }\n  }, [success, error, payment, selectedPaymentMethod, dispatch, orderId, navigate]);\n\n  if (!orderId) {\n    console.error(\"Missing orderId in location state:\", locationState);\n    toast.error(\"Order information not found.\");\n    navigate(\"/\");\n    return null;\n  }\n\n  // Handle PayOS iframe loading error\n  const handlePayOsIframeError = () => {\n    console.error(\"Error loading PayOS payment iframe\");\n    toast.error(\"Payment gateway failed to load. Please try another payment method.\");\n    setShowPayosIframe(false);\n    dispatch(resetPayment());\n  };\n\n  const handlePayment = () => {\n    if (!orderId) {\n      toast.error(\"Order information not found.\");\n      navigate(\"/\");\n      return;\n    }\n\n    if (selectedPaymentMethod === 'PayOS') {\n      toast.info(\"Opening payment gateway...\");\n    }\n\n    // Ensure orderId is passed as a string\n    dispatch(createPayment({\n      orderId: String(orderId),\n      method: selectedPaymentMethod,\n      replaceExisting: comingFromOrderPage // Delete previous payment records if coming from order history/detail\n    }));\n  };\n\n  // Xử lý khi đóng cổng thanh toán\n  const handleBackToHome = () => {\n    setShowPayosIframe(false);\n    clearPolling();\n    dispatch(resetPayment());\n    navigate(\"/\");\n  };\n\n  // Open PayOS payment page in new tab\n  const openPaymentPage = () => {\n    if (payment?.paymentUrl) {\n      window.open(payment.paymentUrl, '_blank');\n    }\n  };\n\n  // If coming from order history or order detail, show only PayOS option\n  const renderPaymentMethods = () => {\n    // If coming from order page, only show PayOS option\n    if (comingFromOrderPage) {\n      return (\n        <Paper\n          variant=\"outlined\"\n          sx={{\n            mb: 2,\n            p: 2,\n            borderRadius: 2,\n            borderColor: '#0F52BA',\n            backgroundColor: 'rgba(15, 82, 186, 0.04)',\n            transition: 'all 0.2s'\n          }}\n        >\n          <FormControlLabel\n            value=\"PayPal\"\n            control={<Radio sx={{ color: '#0F52BA', '&.Mui-checked': { color: '#0F52BA' } }} />}\n            label={\n              <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                <PaymentIcon sx={{ mr: 1, color: '#0F52BA' }} />\n                <Typography>PayPal</Typography>\n              </Box>\n            }\n            sx={{ width: '100%' }}\n            checked={true}\n            disabled={true} // Cannot be changed\n          />\n        </Paper>\n      );\n    }\n\n    // Otherwise show all payment options\n    return (\n      <RadioGroup\n        value={selectedPaymentMethod}\n        onChange={(e) => setSelectedPaymentMethod(e.target.value)}\n      >\n        <Paper\n          variant=\"outlined\"\n          sx={{\n            mb: 2,\n            p: 2,\n            borderRadius: 2,\n            borderColor: selectedPaymentMethod === 'COD' ? '#0F52BA' : 'divider',\n            backgroundColor: selectedPaymentMethod === 'COD' ? 'rgba(15, 82, 186, 0.04)' : 'transparent',\n            transition: 'all 0.2s'\n          }}\n        >\n          <FormControlLabel\n            value=\"COD\"\n            control={<Radio sx={{ color: '#0F52BA', '&.Mui-checked': { color: '#0F52BA' } }} />}\n            label={\n              <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                <LocalAtmIcon sx={{ mr: 1, color: '#0F52BA' }} />\n                <Typography>Cash on Delivery (COD)</Typography>\n              </Box>\n            }\n            sx={{ width: '100%' }}\n          />\n        </Paper>\n\n        <Paper\n          variant=\"outlined\"\n          sx={{\n            mb: 2,\n            p: 2,\n            borderRadius: 2,\n            borderColor: selectedPaymentMethod === 'PayOS' ? '#0F52BA' : 'divider',\n            backgroundColor: selectedPaymentMethod === 'PayOS' ? 'rgba(15, 82, 186, 0.04)' : 'transparent',\n            transition: 'all 0.2s'\n          }}\n        >\n          <FormControlLabel\n            value=\"PayOS\"\n            control={<Radio sx={{ color: '#0F52BA', '&.Mui-checked': { color: '#0F52BA' } }} />}\n            label={\n              <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                <PaymentIcon sx={{ mr: 1, color: '#0F52BA' }} />\n                <Typography>PayOS</Typography>\n              </Box>\n            }\n            sx={{ width: '100%' }}\n          />\n        </Paper>\n      </RadioGroup>\n    );\n  };\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 6 }}>\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n      >\n        <Typography\n          variant=\"h4\"\n          component=\"h1\"\n          gutterBottom\n          sx={{\n            fontWeight: 700,\n            color: '#0F52BA',\n            position: 'relative',\n            pb: 2,\n            mb: 4,\n            '&:after': {\n              content: '\"\"',\n              position: 'absolute',\n              bottom: 0,\n              left: 0,\n              width: '60px',\n              height: '4px',\n              backgroundColor: '#0F52BA',\n              borderRadius: '2px'\n            }\n          }}\n        >\n          <PaymentIcon sx={{ mr: 1, verticalAlign: 'middle' }} />\n          {comingFromOrderPage ? 'Payment Method: PayOS' : 'Select Payment Method'}\n        </Typography>\n\n        {showPayosIframe && payment?.paymentUrl ? (\n          <Paper\n            elevation={3}\n            sx={{\n              p: 4,\n              borderRadius: 2,\n              maxWidth: 800,\n              mx: 'auto',\n              overflow: 'hidden',\n              boxShadow: '0 10px 30px rgba(0,0,0,0.1)'\n            }}\n          >\n            <Typography variant=\"h5\" fontWeight={600} mb={3}>\n              PayOS Payment\n            </Typography>\n            <Box\n              sx={{\n                height: \"600px\",\n                border: '1px solid #eaeaea',\n                borderRadius: 2,\n                overflow: 'hidden',\n                mb: 3\n              }}\n            >\n              <iframe\n                ref={payosIframeRef}\n                src={payment.paymentUrl}\n                style={{\n                  width: \"100%\",\n                  height: \"100%\",\n                  border: \"none\"\n                }}\n                title=\"PayOS Payment\"\n                allow=\"payment\"\n                onError={handlePayOsIframeError}\n              />\n            </Box>\n            <Grid container spacing={2} justifyContent=\"space-between\">\n              <Grid item>\n                <Button\n                  variant=\"contained\"\n                  onClick={openPaymentPage}\n                  startIcon={<PaymentIcon />}\n                  sx={{\n                    backgroundColor: '#0F52BA',\n                    '&:hover': {\n                      backgroundColor: '#0A3C8A',\n                    },\n                    px: 3,\n                    py: 1\n                  }}\n                >\n                  Open in new tab\n                </Button>\n              </Grid>\n              <Grid item>\n                <Button\n                  variant=\"outlined\"\n                  onClick={handleBackToHome}\n                  startIcon={<HomeIcon />}\n                  sx={{\n                    borderColor: '#0F52BA',\n                    color: '#0F52BA',\n                    '&:hover': {\n                      borderColor: '#0A3C8A',\n                      backgroundColor: 'rgba(15, 82, 186, 0.04)',\n                    },\n                    px: 3,\n                    py: 1\n                  }}\n                >\n                  Return to home\n                </Button>\n              </Grid>\n            </Grid>\n          </Paper>\n        ) : (\n          <Grid container spacing={4}>\n            <Grid item xs={12} md={7}>\n              <Paper\n                elevation={3}\n                sx={{\n                  p: 4,\n                  borderRadius: 2,\n                  height: '100%',\n                  boxShadow: '0 10px 30px rgba(0,0,0,0.1)'\n                }}\n              >\n                <Typography variant=\"h5\" fontWeight={600} mb={3}>\n                  {comingFromOrderPage ? 'Payment Method' : 'Choose Payment Method'}\n                </Typography>\n\n                <FormControl component=\"fieldset\" sx={{ width: '100%' }}>\n                  {renderPaymentMethods()}\n                </FormControl>\n\n                {!success && (\n                  <Button\n                    variant=\"contained\"\n                    fullWidth\n                    size=\"large\"\n                    onClick={handlePayment}\n                    disabled={loading}\n                    sx={{\n                      mt: 3,\n                      py: 1.5,\n                      backgroundColor: '#0F52BA',\n                      '&:hover': {\n                        backgroundColor: '#0A3C8A',\n                      },\n                      fontWeight: 600\n                    }}\n                  >\n                    {loading ? (\n                      <>\n                        <CircularProgress size={24} sx={{ color: 'white', mr: 1 }} />\n                        Processing...\n                      </>\n                    ) : (\n                      'Proceed to Payment'\n                    )}\n                  </Button>\n                )}\n\n                {success && (\n                  <Button\n                    variant=\"outlined\"\n                    fullWidth\n                    size=\"large\"\n                    onClick={handleBackToHome}\n                    startIcon={<HomeIcon />}\n                    sx={{\n                      mt: 3,\n                      py: 1.5,\n                      borderColor: '#0F52BA',\n                      color: '#0F52BA',\n                      '&:hover': {\n                        borderColor: '#0A3C8A',\n                        backgroundColor: 'rgba(15, 82, 186, 0.04)',\n                      },\n                      fontWeight: 600\n                    }}\n                  >\n                    Return to Home\n                  </Button>\n                )}\n              </Paper>\n            </Grid>\n\n            <Grid item xs={12} md={5}>\n              <Paper\n                elevation={3}\n                sx={{\n                  p: 4,\n                  borderRadius: 2,\n                  boxShadow: '0 10px 30px rgba(0,0,0,0.1)'\n                }}\n              >\n                <Typography variant=\"h5\" fontWeight={600} mb={3}>\n                  Order Summary\n                </Typography>\n\n                <Box sx={{ mb: 3 }}>\n                  <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 2 }}>\n                    <Typography variant=\"body1\" color=\"text.secondary\">Order ID:</Typography>\n                    <Typography variant=\"body1\" fontWeight={500}>{orderId}</Typography>\n                  </Box>\n\n                  <Divider sx={{ my: 2 }} />\n\n                  <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 1 }}>\n                    <Typography variant=\"h6\">Total:</Typography>\n                    <Typography variant=\"h6\" fontWeight={700} color=\"#0F52BA\">\n                      ${formattedPrice}\n                    </Typography>\n                  </Box>\n                </Box>\n\n                <Box sx={{\n                  p: 2,\n                  backgroundColor: 'rgba(15, 82, 186, 0.04)',\n                  borderRadius: 2,\n                  border: '1px dashed #0F52BA'\n                }}>\n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    By proceeding with this payment, you agree to our terms and conditions.\n                    {!comingFromOrderPage && ' For Cash on Delivery orders, please have the exact amount ready at the time of delivery.'}\n                  </Typography>\n                </Box>\n              </Paper>\n\n              <Button\n                variant=\"text\"\n                startIcon={<ArrowBackIcon />}\n                onClick={() => navigate(-1)}\n                sx={{\n                  mt: 2,\n                  color: '#0F52BA',\n                  '&:hover': {\n                    backgroundColor: 'rgba(15, 82, 186, 0.04)',\n                  }\n                }}\n              >\n                Back to Checkout\n              </Button>\n            </Grid>\n          </Grid>\n        )}\n      </motion.div>\n    </Container>\n  );\n};\n\nexport default Payment;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}